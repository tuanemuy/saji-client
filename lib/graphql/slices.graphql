mutation CreateSlice($user_id: String!) {
  insert_slices_one(
    object: { user_id: $user_id, revisions: { data: { content: "" } } }
  ) {
    id
    created_at
    user_id
    revisions(order_by: { created_at: desc }) {
      id
      content
      created_at
      updated_at
    }
    tags(order_by: { tag_id: asc }) {
      tag {
        id
        name
        color {
          id
          hex
        }
      }
    }
  }
}

query GetSlice($id: bigint!) {
  slices_by_pk(id: $id) {
    id
    created_at
    user_id
    revisions(order_by: { created_at: desc }) {
      id
      content
      created_at
      updated_at
    }
    tags(order_by: { tag_id: asc }) {
      tag {
        id
        name
        color {
          id
          hex
        }
      }
    }
  }
}

query GetSliceIds($limit: Int = 30, $offset: Int = 0, $user_id: String!) {
  slices(
    limit: $limit
    offset: $offset
    order_by: { created_at: desc }
    where: { _and: { user_id: { _eq: $user_id } } }
  ) {
    id
  }
}

query GetSlices($limit: Int = 30, $offset: Int = 0, $user_id: String!) {
  slices(
    limit: $limit
    offset: $offset
    order_by: { created_at: desc }
    where: { _and: { user_id: { _eq: $user_id } } }
  ) {
    id
    created_at
    user_id
    revisions(limit: 1, order_by: { created_at: desc }) {
      id
      content
      created_at
      updated_at
    }
    tags(order_by: { tag_id: asc }) {
      tag {
        id
        name
        color {
          id
          hex
        }
      }
    }
  }
}

query GetSliceIdsByTags(
  $limit: Int = 30
  $offset: Int = 0
  $user_id: String!
  $tag_ids: [bigint!] = []
) {
  slices(
    limit: $limit
    offset: $offset
    order_by: { created_at: desc }
    where: {
      _and: { user_id: { _eq: $user_id }, tags: { tag_id: { _in: $tag_ids } } }
    }
  ) {
    id
  }
}

query GetSlicesByTags(
  $limit: Int = 30
  $offset: Int = 0
  $user_id: String!
  $tag_ids: [bigint!] = []
) {
  slices(
    limit: $limit
    offset: $offset
    order_by: { created_at: desc }
    where: {
      _and: { user_id: { _eq: $user_id }, tags: { tag_id: { _in: $tag_ids } } }
    }
  ) {
    id
    created_at
    user_id
    revisions(limit: 1, order_by: { created_at: desc }) {
      id
      content
      created_at
      updated_at
    }
    tags(order_by: { tag_id: asc }) {
      tag {
        id
        name
        color {
          id
          hex
        }
      }
    }
  }
}

mutation DeleteSlice($id: bigint!) {
  delete_slices_by_pk(id: $id) {
    id
    created_at
    user_id
    revisions(order_by: { created_at: desc }) {
      id
      content
      created_at
      updated_at
    }
    tags(order_by: { tag_id: asc }) {
      tag {
        id
        name
        color {
          id
          hex
        }
      }
    }
  }
}
